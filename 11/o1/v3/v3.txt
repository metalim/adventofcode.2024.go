Если не хватает памяти, то надо использовать файлы для хранения? у тебя такая ебанутая логика, да?
Ищи другой подход к решению
